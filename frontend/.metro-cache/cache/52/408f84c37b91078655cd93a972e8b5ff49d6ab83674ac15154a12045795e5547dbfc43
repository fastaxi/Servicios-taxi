{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":78,"index":78}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":79},"end":{"line":2,"column":69,"index":148}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"@react-native-community/netinfo","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":149},"end":{"line":3,"column":54,"index":203}}],"key":"PqZcYTlMIVnzFjdViPzMiGUu7Hg=","exportNames":["*"],"imports":1}},{"name":"axios","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":204},"end":{"line":4,"column":26,"index":230}}],"key":"e45rENb5cSu0Yeh6oC1uWb7lEp4=","exportNames":["*"],"imports":1}},{"name":"./AuthContext","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":231},"end":{"line":5,"column":40,"index":271}}],"key":"YmpzODa+dVz64UAAYTI+RwJeEt0=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/contexts/SyncContext.tsx\";\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.SyncProvider = SyncProvider;\n  exports.useSync = useSync;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _reactNativeCommunityNetinfo = require(_dependencyMap[2], \"@react-native-community/netinfo\");\n  var NetInfo = _interopDefault(_reactNativeCommunityNetinfo);\n  var _axios = require(_dependencyMap[3], \"axios\");\n  var axios = _interopDefault(_axios);\n  var _AuthContext = require(_dependencyMap[4], \"./AuthContext\");\n  var _reactJsxDevRuntime = require(_dependencyMap[5], \"react/jsx-dev-runtime\");\n  const API_URL = process.env.EXPO_PUBLIC_BACKEND_URL + '/api';\n  const SyncContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  function SyncProvider({\n    children\n  }) {\n    const [pendingServices, setPendingServices] = (0, _react.useState)(0);\n    const [syncStatus, setSyncStatus] = (0, _react.useState)('idle');\n    const {\n      token\n    } = (0, _AuthContext.useAuth)();\n    (0, _react.useEffect)(() => {\n      loadPendingCount();\n\n      // Listen for network changes\n      const unsubscribe = NetInfo.default.addEventListener(state => {\n        if (state.isConnected && pendingServices > 0) {\n          syncServices();\n        }\n      });\n      return () => unsubscribe();\n    }, [pendingServices, token]);\n    const loadPendingCount = async () => {\n      try {\n        const pending = await AsyncStorage.default.getItem('pendingServices');\n        if (pending) {\n          const services = JSON.parse(pending);\n          setPendingServices(services.length);\n        }\n      } catch (error) {\n        console.error('Error loading pending count:', error);\n      }\n    };\n    const addPendingService = async service => {\n      try {\n        const pending = await AsyncStorage.default.getItem('pendingServices');\n        const services = pending ? JSON.parse(pending) : [];\n        services.push(service);\n        await AsyncStorage.default.setItem('pendingServices', JSON.stringify(services));\n        setPendingServices(services.length);\n\n        // Try to sync immediately if connected\n        const netInfo = await NetInfo.default.fetch();\n        if (netInfo.isConnected) {\n          await syncServices();\n        }\n      } catch (error) {\n        console.error('Error adding pending service:', error);\n      }\n    };\n    const syncServices = async () => {\n      if (!token || syncStatus === 'syncing') return;\n      try {\n        setSyncStatus('syncing');\n        const pending = await AsyncStorage.default.getItem('pendingServices');\n        if (!pending) {\n          setSyncStatus('idle');\n          return;\n        }\n        const services = JSON.parse(pending);\n        if (services.length === 0) {\n          setSyncStatus('idle');\n          return;\n        }\n        const response = await axios.default.post(`${API_URL}/services/sync`, {\n          services\n        }, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n\n        // Clear pending services\n        await AsyncStorage.default.removeItem('pendingServices');\n        setPendingServices(0);\n        setSyncStatus('success');\n        setTimeout(() => setSyncStatus('idle'), 2000);\n      } catch (error) {\n        console.error('Sync error:', error);\n        setSyncStatus('error');\n        setTimeout(() => setSyncStatus('idle'), 3000);\n      }\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(SyncContext.Provider, {\n      value: {\n        pendingServices,\n        syncStatus,\n        syncServices,\n        addPendingService\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 5\n    }, this);\n  }\n  function useSync() {\n    const context = (0, _react.useContext)(SyncContext);\n    if (context === undefined) {\n      throw new Error('useSync must be used within a SyncProvider');\n    }\n    return context;\n  }\n});","lineCount":127,"map":[[13,2,18,0,"exports"],[13,9,18,0],[13,10,18,0,"SyncProvider"],[13,22,18,0],[13,25,18,0,"SyncProvider"],[13,37,18,0],[14,2,111,0,"exports"],[14,9,111,0],[14,10,111,0,"useSync"],[14,17,111,0],[14,20,111,0,"useSync"],[14,27,111,0],[15,2,1,0],[15,6,1,0,"_react"],[15,12,1,0],[15,15,1,0,"require"],[15,22,1,0],[15,23,1,0,"_dependencyMap"],[15,37,1,0],[16,2,2,0],[16,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[16,42,2,0],[16,45,2,0,"require"],[16,52,2,0],[16,53,2,0,"_dependencyMap"],[16,67,2,0],[17,2,2,0],[17,6,2,0,"AsyncStorage"],[17,18,2,0],[17,21,2,0,"_interopDefault"],[17,36,2,0],[17,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[17,73,2,0],[18,2,3,0],[18,6,3,0,"_reactNativeCommunityNetinfo"],[18,34,3,0],[18,37,3,0,"require"],[18,44,3,0],[18,45,3,0,"_dependencyMap"],[18,59,3,0],[19,2,3,0],[19,6,3,0,"NetInfo"],[19,13,3,0],[19,16,3,0,"_interopDefault"],[19,31,3,0],[19,32,3,0,"_reactNativeCommunityNetinfo"],[19,60,3,0],[20,2,4,0],[20,6,4,0,"_axios"],[20,12,4,0],[20,15,4,0,"require"],[20,22,4,0],[20,23,4,0,"_dependencyMap"],[20,37,4,0],[21,2,4,0],[21,6,4,0,"axios"],[21,11,4,0],[21,14,4,0,"_interopDefault"],[21,29,4,0],[21,30,4,0,"_axios"],[21,36,4,0],[22,2,5,0],[22,6,5,0,"_AuthContext"],[22,18,5,0],[22,21,5,0,"require"],[22,28,5,0],[22,29,5,0,"_dependencyMap"],[22,43,5,0],[23,2,5,40],[23,6,5,40,"_reactJsxDevRuntime"],[23,25,5,40],[23,28,5,40,"require"],[23,35,5,40],[23,36,5,40,"_dependencyMap"],[23,50,5,40],[24,2,7,0],[24,8,7,6,"API_URL"],[24,15,7,13],[24,18,7,16,"process"],[24,25,7,23],[24,26,7,24,"env"],[24,29,7,27],[24,30,7,28,"EXPO_PUBLIC_BACKEND_URL"],[24,53,7,51],[24,56,7,54],[24,62,7,60],[25,2,16,0],[25,8,16,6,"SyncContext"],[25,19,16,17],[25,35,16,20],[25,39,16,20,"createContext"],[25,45,16,33],[25,46,16,33,"createContext"],[25,59,16,33],[25,61,16,63,"undefined"],[25,70,16,72],[25,71,16,73],[26,2,18,7],[26,11,18,16,"SyncProvider"],[26,23,18,28,"SyncProvider"],[26,24,18,29],[27,4,18,31,"children"],[28,2,18,71],[28,3,18,72],[28,5,18,74],[29,4,19,2],[29,10,19,8],[29,11,19,9,"pendingServices"],[29,26,19,24],[29,28,19,26,"setPendingServices"],[29,46,19,44],[29,47,19,45],[29,50,19,48],[29,54,19,48,"useState"],[29,60,19,56],[29,61,19,56,"useState"],[29,69,19,56],[29,71,19,57],[29,72,19,58],[29,73,19,59],[30,4,20,2],[30,10,20,8],[30,11,20,9,"syncStatus"],[30,21,20,19],[30,23,20,21,"setSyncStatus"],[30,36,20,34],[30,37,20,35],[30,40,20,38],[30,44,20,38,"useState"],[30,50,20,46],[30,51,20,46,"useState"],[30,59,20,46],[30,61,20,89],[30,67,20,95],[30,68,20,96],[31,4,21,2],[31,10,21,8],[32,6,21,10,"token"],[33,4,21,16],[33,5,21,17],[33,8,21,20],[33,12,21,20,"useAuth"],[33,24,21,27],[33,25,21,27,"useAuth"],[33,32,21,27],[33,34,21,28],[33,35,21,29],[34,4,23,2],[34,8,23,2,"useEffect"],[34,14,23,11],[34,15,23,11,"useEffect"],[34,24,23,11],[34,26,23,12],[34,32,23,18],[35,6,24,4,"loadPendingCount"],[35,22,24,20],[35,23,24,21],[35,24,24,22],[37,6,26,4],[38,6,27,4],[38,12,27,10,"unsubscribe"],[38,23,27,21],[38,26,27,24,"NetInfo"],[38,33,27,31],[38,34,27,31,"default"],[38,41,27,31],[38,42,27,32,"addEventListener"],[38,58,27,48],[38,59,27,49,"state"],[38,64,27,54],[38,68,27,58],[39,8,28,6],[39,12,28,10,"state"],[39,17,28,15],[39,18,28,16,"isConnected"],[39,29,28,27],[39,33,28,31,"pendingServices"],[39,48,28,46],[39,51,28,49],[39,52,28,50],[39,54,28,52],[40,10,29,8,"syncServices"],[40,22,29,20],[40,23,29,21],[40,24,29,22],[41,8,30,6],[42,6,31,4],[42,7,31,5],[42,8,31,6],[43,6,33,4],[43,13,33,11],[43,19,33,17,"unsubscribe"],[43,30,33,28],[43,31,33,29],[43,32,33,30],[44,4,34,2],[44,5,34,3],[44,7,34,5],[44,8,34,6,"pendingServices"],[44,23,34,21],[44,25,34,23,"token"],[44,30,34,28],[44,31,34,29],[44,32,34,30],[45,4,36,2],[45,10,36,8,"loadPendingCount"],[45,26,36,24],[45,29,36,27],[45,35,36,27,"loadPendingCount"],[45,36,36,27],[45,41,36,39],[46,6,37,4],[46,10,37,8],[47,8,38,6],[47,14,38,12,"pending"],[47,21,38,19],[47,24,38,22],[47,30,38,28,"AsyncStorage"],[47,42,38,40],[47,43,38,40,"default"],[47,50,38,40],[47,51,38,41,"getItem"],[47,58,38,48],[47,59,38,49],[47,76,38,66],[47,77,38,67],[48,8,39,6],[48,12,39,10,"pending"],[48,19,39,17],[48,21,39,19],[49,10,40,8],[49,16,40,14,"services"],[49,24,40,22],[49,27,40,25,"JSON"],[49,31,40,29],[49,32,40,30,"parse"],[49,37,40,35],[49,38,40,36,"pending"],[49,45,40,43],[49,46,40,44],[50,10,41,8,"setPendingServices"],[50,28,41,26],[50,29,41,27,"services"],[50,37,41,35],[50,38,41,36,"length"],[50,44,41,42],[50,45,41,43],[51,8,42,6],[52,6,43,4],[52,7,43,5],[52,8,43,6],[52,15,43,13,"error"],[52,20,43,18],[52,22,43,20],[53,8,44,6,"console"],[53,15,44,13],[53,16,44,14,"error"],[53,21,44,19],[53,22,44,20],[53,52,44,50],[53,54,44,52,"error"],[53,59,44,57],[53,60,44,58],[54,6,45,4],[55,4,46,2],[55,5,46,3],[56,4,48,2],[56,10,48,8,"addPendingService"],[56,27,48,25],[56,30,48,28],[56,36,48,35,"service"],[56,43,48,47],[56,47,48,52],[57,6,49,4],[57,10,49,8],[58,8,50,6],[58,14,50,12,"pending"],[58,21,50,19],[58,24,50,22],[58,30,50,28,"AsyncStorage"],[58,42,50,40],[58,43,50,40,"default"],[58,50,50,40],[58,51,50,41,"getItem"],[58,58,50,48],[58,59,50,49],[58,76,50,66],[58,77,50,67],[59,8,51,6],[59,14,51,12,"services"],[59,22,51,20],[59,25,51,23,"pending"],[59,32,51,30],[59,35,51,33,"JSON"],[59,39,51,37],[59,40,51,38,"parse"],[59,45,51,43],[59,46,51,44,"pending"],[59,53,51,51],[59,54,51,52],[59,57,51,55],[59,59,51,57],[60,8,52,6,"services"],[60,16,52,14],[60,17,52,15,"push"],[60,21,52,19],[60,22,52,20,"service"],[60,29,52,27],[60,30,52,28],[61,8,53,6],[61,14,53,12,"AsyncStorage"],[61,26,53,24],[61,27,53,24,"default"],[61,34,53,24],[61,35,53,25,"setItem"],[61,42,53,32],[61,43,53,33],[61,60,53,50],[61,62,53,52,"JSON"],[61,66,53,56],[61,67,53,57,"stringify"],[61,76,53,66],[61,77,53,67,"services"],[61,85,53,75],[61,86,53,76],[61,87,53,77],[62,8,54,6,"setPendingServices"],[62,26,54,24],[62,27,54,25,"services"],[62,35,54,33],[62,36,54,34,"length"],[62,42,54,40],[62,43,54,41],[64,8,56,6],[65,8,57,6],[65,14,57,12,"netInfo"],[65,21,57,19],[65,24,57,22],[65,30,57,28,"NetInfo"],[65,37,57,35],[65,38,57,35,"default"],[65,45,57,35],[65,46,57,36,"fetch"],[65,51,57,41],[65,52,57,42],[65,53,57,43],[66,8,58,6],[66,12,58,10,"netInfo"],[66,19,58,17],[66,20,58,18,"isConnected"],[66,31,58,29],[66,33,58,31],[67,10,59,8],[67,16,59,14,"syncServices"],[67,28,59,26],[67,29,59,27],[67,30,59,28],[68,8,60,6],[69,6,61,4],[69,7,61,5],[69,8,61,6],[69,15,61,13,"error"],[69,20,61,18],[69,22,61,20],[70,8,62,6,"console"],[70,15,62,13],[70,16,62,14,"error"],[70,21,62,19],[70,22,62,20],[70,53,62,51],[70,55,62,53,"error"],[70,60,62,58],[70,61,62,59],[71,6,63,4],[72,4,64,2],[72,5,64,3],[73,4,66,2],[73,10,66,8,"syncServices"],[73,22,66,20],[73,25,66,23],[73,31,66,23,"syncServices"],[73,32,66,23],[73,37,66,35],[74,6,67,4],[74,10,67,8],[74,11,67,9,"token"],[74,16,67,14],[74,20,67,18,"syncStatus"],[74,30,67,28],[74,35,67,33],[74,44,67,42],[74,46,67,44],[75,6,69,4],[75,10,69,8],[76,8,70,6,"setSyncStatus"],[76,21,70,19],[76,22,70,20],[76,31,70,29],[76,32,70,30],[77,8,71,6],[77,14,71,12,"pending"],[77,21,71,19],[77,24,71,22],[77,30,71,28,"AsyncStorage"],[77,42,71,40],[77,43,71,40,"default"],[77,50,71,40],[77,51,71,41,"getItem"],[77,58,71,48],[77,59,71,49],[77,76,71,66],[77,77,71,67],[78,8,73,6],[78,12,73,10],[78,13,73,11,"pending"],[78,20,73,18],[78,22,73,20],[79,10,74,8,"setSyncStatus"],[79,23,74,21],[79,24,74,22],[79,30,74,28],[79,31,74,29],[80,10,75,8],[81,8,76,6],[82,8,78,6],[82,14,78,12,"services"],[82,22,78,20],[82,25,78,23,"JSON"],[82,29,78,27],[82,30,78,28,"parse"],[82,35,78,33],[82,36,78,34,"pending"],[82,43,78,41],[82,44,78,42],[83,8,80,6],[83,12,80,10,"services"],[83,20,80,18],[83,21,80,19,"length"],[83,27,80,25],[83,32,80,30],[83,33,80,31],[83,35,80,33],[84,10,81,8,"setSyncStatus"],[84,23,81,21],[84,24,81,22],[84,30,81,28],[84,31,81,29],[85,10,82,8],[86,8,83,6],[87,8,85,6],[87,14,85,12,"response"],[87,22,85,20],[87,25,85,23],[87,31,85,29,"axios"],[87,36,85,34],[87,37,85,34,"default"],[87,44,85,34],[87,45,85,35,"post"],[87,49,85,39],[87,50,86,8],[87,53,86,11,"API_URL"],[87,60,86,18],[87,76,86,34],[87,78,87,8],[88,10,87,10,"services"],[89,8,87,19],[89,9,87,20],[89,11,88,8],[90,10,88,10,"headers"],[90,17,88,17],[90,19,88,19],[91,12,88,21,"Authorization"],[91,25,88,34],[91,27,88,36],[91,37,88,46,"token"],[91,42,88,51],[92,10,88,54],[93,8,88,56],[93,9,89,6],[93,10,89,7],[95,8,91,6],[96,8,92,6],[96,14,92,12,"AsyncStorage"],[96,26,92,24],[96,27,92,24,"default"],[96,34,92,24],[96,35,92,25,"removeItem"],[96,45,92,35],[96,46,92,36],[96,63,92,53],[96,64,92,54],[97,8,93,6,"setPendingServices"],[97,26,93,24],[97,27,93,25],[97,28,93,26],[97,29,93,27],[98,8,94,6,"setSyncStatus"],[98,21,94,19],[98,22,94,20],[98,31,94,29],[98,32,94,30],[99,8,96,6,"setTimeout"],[99,18,96,16],[99,19,96,17],[99,25,96,23,"setSyncStatus"],[99,38,96,36],[99,39,96,37],[99,45,96,43],[99,46,96,44],[99,48,96,46],[99,52,96,50],[99,53,96,51],[100,6,97,4],[100,7,97,5],[100,8,97,6],[100,15,97,13,"error"],[100,20,97,18],[100,22,97,20],[101,8,98,6,"console"],[101,15,98,13],[101,16,98,14,"error"],[101,21,98,19],[101,22,98,20],[101,35,98,33],[101,37,98,35,"error"],[101,42,98,40],[101,43,98,41],[102,8,99,6,"setSyncStatus"],[102,21,99,19],[102,22,99,20],[102,29,99,27],[102,30,99,28],[103,8,100,6,"setTimeout"],[103,18,100,16],[103,19,100,17],[103,25,100,23,"setSyncStatus"],[103,38,100,36],[103,39,100,37],[103,45,100,43],[103,46,100,44],[103,48,100,46],[103,52,100,50],[103,53,100,51],[104,6,101,4],[105,4,102,2],[105,5,102,3],[106,4,104,2],[106,24,105,4],[106,28,105,4,"_reactJsxDevRuntime"],[106,47,105,4],[106,48,105,4,"jsxDEV"],[106,54,105,4],[106,56,105,5,"SyncContext"],[106,67,105,16],[106,68,105,17,"Provider"],[106,76,105,25],[107,6,105,26,"value"],[107,11,105,31],[107,13,105,33],[108,8,105,35,"pendingServices"],[108,23,105,50],[109,8,105,52,"syncStatus"],[109,18,105,62],[110,8,105,64,"syncServices"],[110,20,105,76],[111,8,105,78,"addPendingService"],[112,6,105,96],[112,7,105,98],[113,6,105,98,"children"],[113,14,105,98],[113,16,106,7,"children"],[114,4,106,15],[115,6,106,15,"fileName"],[115,14,106,15],[115,16,106,15,"_jsxFileName"],[115,28,106,15],[116,6,106,15,"lineNumber"],[116,16,106,15],[117,6,106,15,"columnNumber"],[117,18,106,15],[118,4,106,15],[118,11,107,26],[118,12,107,27],[119,2,109,0],[120,2,111,7],[120,11,111,16,"useSync"],[120,18,111,23,"useSync"],[120,19,111,23],[120,21,111,26],[121,4,112,2],[121,10,112,8,"context"],[121,17,112,15],[121,20,112,18],[121,24,112,18,"useContext"],[121,30,112,28],[121,31,112,28,"useContext"],[121,41,112,28],[121,43,112,29,"SyncContext"],[121,54,112,40],[121,55,112,41],[122,4,113,2],[122,8,113,6,"context"],[122,15,113,13],[122,20,113,18,"undefined"],[122,29,113,27],[122,31,113,29],[123,6,114,4],[123,12,114,10],[123,16,114,14,"Error"],[123,21,114,19],[123,22,114,20],[123,66,114,64],[123,67,114,65],[124,4,115,2],[125,4,116,2],[125,11,116,9,"context"],[125,18,116,16],[126,2,117,0],[127,0,117,1],[127,3]],"functionMap":{"names":["<global>","SyncProvider","useEffect$argument_0","NetInfo.addEventListener$argument_0","<anonymous>","loadPendingCount","addPendingService","syncServices","setTimeout$argument_0","useSync"],"mappings":"AAA;OCiB;YCK;iDCI;KDI;WEE,mBF;GDC;2BIE;GJU;4BKE;GLgB;uBME;iBC8B,2BD;iBCI,2BD;GNE;CDO;OSE;CTM"},"hasCjsExports":false},"type":"js/module"}]}